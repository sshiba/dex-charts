{{- define "Service-dex" -}}
---
apiVersion: v1
kind: Service
metadata:
  name: {{ template "helpers.labels.fullname" . }}
  labels: {{- include "helpers.labels.labels" . | nindent 4 }}
spec:
  # type: NodePort
  # ports:
  # - name: http
  #   targetPort: http
  #   port: {{ .Values.params.endpoints.port.http }}
  #   nodePort: {{ .Values.params.endpoints.nodePort.http }}
  #   protocol: TCP
  # - name: https
  #   targetPort: https
  #   port: {{ .Values.params.endpoints.port.https }}
  #   nodePort: {{ .Values.params.endpoints.nodePort.https }}
  #   protocol: TCP
  type: LoadBalancer
  ports:
  - name: http
    port: {{ .Values.params.endpoints.port.http }}
    nodePort: {{ .Values.params.endpoints.nodePort.http }}
    targetPort: http
    protocol: TCP
  - name: https
    port: {{ .Values.params.endpoints.port.https }}
    nodePort: {{ .Values.params.endpoints.nodePort.https }}
    targetPort: https
    protocol: TCP
  selector: {{- include "helpers.labels.matchLabels" . | nindent 4 }}
...
{{- end -}}
{{- include "helpers.template.overlay" ( dict "Global" $ "template_definition" "Service-dex" ) }}